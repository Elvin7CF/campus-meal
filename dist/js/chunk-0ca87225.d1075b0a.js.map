{"version":3,"sources":["webpack:///./src/api/upload.js","webpack:///./src/views/order/comment.vue?1113","webpack:///./src/views/order/star.vue?0f9a","webpack:///src/views/order/star.vue","webpack:///./src/views/order/star.vue?ee30","webpack:///./src/views/order/star.vue","webpack:///src/views/order/comment.vue","webpack:///./src/views/order/comment.vue?6c0e","webpack:///./src/views/order/comment.vue","webpack:///./src/views/order/star.vue?bc60","webpack:///./src/views/order/comment.vue?9583","webpack:///./src/api/order.js"],"names":["uploadToken","data","req","url","_get","upload","formData","FormData","Object","keys","forEach","key","append","_postNoWithCredentials","render","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","_m","on","setDeliveryScore","restaurant_info","pic_url","_v","_s","name","setFoodScore","directives","rawName","value","expression","staticStyle","domProps","$event","target","composing","commentData","input","_l","item","index","deletePic","ref","fileUpload","uploadList","length","hiddenName","class","active","satisfySubmit","submit","alertText","showTip","staticRenderFns","makeScore","component","submitOrder","_post","initPay","orderInfo","order_id","orders","makeComment","listenStatus"],"mappings":"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","file":"js/chunk-0ca87225.d1075b0a.js","sourcesContent":["import {_get, _postNoWithCredentials} from './index'\n//获取七牛云上次凭证\nexport const uploadToken = (data) => {\n  let req = {\n    data,\n    url: 'service/uploadtoken'\n  };\n  return _get(req);\n}\n\n//上传\nexport const upload = (data) => {\n  let formData = new FormData();\n  Object.keys(data).forEach(key => {\n    formData.append(key, data[key])\n  })\n  let req = {\n    data: formData,\n    url: '/upload-z2.qiniup.com/'\n  }\n  return _postNoWithCredentials(req);\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"comment\"}},[_c('v-head',{attrs:{\"title\":\"评论\",\"goBack\":\"true\",\"bgColor\":\"#f4f4f4\"}}),_c('div',{staticClass:\"deliver-comment\"},[_vm._m(0),_c('star',{on:{\"makeScore\":_vm.setDeliveryScore}})],1),_c('div',{staticClass:\"main-container\"},[_c('div',{staticClass:\"restaurant-info\"},[_c('span',{staticClass:\"avatar\"},[_c('img',{attrs:{\"src\":_vm.restaurant_info.pic_url}})]),_c('span',{staticClass:\"restaurant-name\"},[_vm._v(_vm._s(_vm.restaurant_info.name))])]),_c('star',{on:{\"makeScore\":_vm.setFoodScore}}),_c('div',{staticClass:\"food-comment\"},[_c('textarea',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.commentData),expression:\"commentData\"}],staticClass:\"comment-data\",staticStyle:{\"resize\":\"none\"},attrs:{\"placeholder\":\"亲，菜品口味如何，对包装服务等还满意吗？\"},domProps:{\"value\":(_vm.commentData)},on:{\"input\":[function($event){if($event.target.composing){ return; }_vm.commentData=$event.target.value},function($event){return _vm.input($event);}]}}),_c('span',{staticClass:\"tip\"},[_vm._v(\"至少输入2个字\")])]),_c('div',{staticClass:\"upload-picture-container\"},[_vm._l((_vm.uploadList),function(item,index){return _c('div',{key:index,staticClass:\"uplist-container\"},[_c('div',{staticClass:\"pic\"},[_c('img',{attrs:{\"src\":item}})]),_c('div',{staticClass:\"delete\",on:{\"click\":function($event){return _vm.deletePic(index)}}},[_c('i',{staticClass:\"iconfont icon-delete\"},[_vm._v(\"\")])])])}),_c('label',{staticClass:\"upload\"},[_c('i',{staticClass:\"iconfont upload-icon\"},[_vm._v(\"\")]),_c('input',{ref:\"referenceUpload\",staticStyle:{\"display\":\"none\"},attrs:{\"id\":\"file\",\"type\":\"file\"},on:{\"change\":function($event){return _vm.fileUpload($event)}}})]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.uploadList.length),expression:\"!uploadList.length\"}],staticClass:\"upload-description\"},[_c('h3',[_vm._v(\"上传图片\")]),_c('p',[_vm._v(\"内容丰富的评论有机会成为优质评价哦\")])])],2)],1),_c('div',{staticClass:\"hidden-name-comment\"},[(!_vm.hiddenName)?_c('span',{staticClass:\"selector no-select\",on:{\"click\":function($event){_vm.hiddenName = !_vm.hiddenName;}}}):_c('span',{staticClass:\"selector select\"},[_c('i',{staticClass:\"iconfont\",on:{\"click\":function($event){_vm.hiddenName = !_vm.hiddenName;}}},[_vm._v(\"\")])]),_c('h4',[_vm._v(\"匿名评价\")])]),_c('div',{staticClass:\"submit\",class:{active:_vm.satisfySubmit},on:{\"click\":function($event){return _vm.submit()}}},[_c('span',[_vm._v(\"提交\")])]),_c('v-loading',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.loading),expression:\"loading\"}]}),_c('alert-tip',{attrs:{\"text\":_vm.alertText,\"showTip\":_vm.showTip},on:{\"update:showTip\":function($event){_vm.showTip=$event},\"update:show-tip\":function($event){_vm.showTip=$event}}})],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"deliver-info\"},[_c('div',{staticClass:\"avatar\"},[_c('img',{attrs:{\"src\":\"http://5b0988e595225.cdn.sohucs.com/images/20190706/b4b3e0f0244849a59c2ef114308fae2c.jpeg\"}})]),_c('div',{staticClass:\"info-container\"},[_c('span',{staticClass:\"deliver-type\"},[_vm._v(\"美团快送\")]),_c('div',{staticClass:\"deliver-time\"},[_c('span',[_vm._v(\"今天19：10左右送达\")]),_c('span',{staticClass:\"time-error\"},[_vm._v(\"时间不准 \"),_c('i',{staticClass:\"iconfont\"},[_vm._v(\"\")])])])])])}]\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"star-container\"},_vm._l((_vm.score),function(item,index){return _c('i',{key:index,class:[\"iconfont\", \"star\",item? \"active\":\"no-active\"],on:{\"click\":function($event){return _vm.makeScore(item,index)}}},[_vm._v(\"\")])}),0)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!--选择评分-->\n<template>\n  <div class=\"star-container\">\n    <i :class='[\"iconfont\", \"star\",item? \"active\":\"no-active\"]' v-for=\"(item,index) in score\" @click=\"makeScore(item,index)\" :key=\"index\">&#xe70a;</i>\n   \n  </div>\n</template>\n\n<script>\n  export default {\n    data(){\n      return {\n        score:[1,0,0,0,0]   //默认1分\n      }\n    },\n    methods:{\n      makeScore(item,index){\n        let scoreIndex = item == 1? 0 : 1; \n        this.score.splice(index,1,scoreIndex)\n        let sum = 0;\n        this.score.forEach(function(item){\n          sum += item;\n        })\n        this.$emit('makeScore', sum);\n      }\n    }\n  }\n</script>\n\n<style rel=\"stylesheet/scss\" lang=\"scss\" scoped>\n  @import \"../../style/mixin\";\n  .star-container{\n    display: flex;\n    justify-content: center;\n    @include px2rem(height,140);\n    margin:0 0.5rem;\n    padding:0.5rem 0;\n    border-top:1px solid $mtGrey;\n    text-align: center;\n    .star{\n      margin:0 0.1rem;\n    }\n    .active{\n      color:$mtYellow;\n    }\n    .no-active{\n      color:#999;\n    }\n  }\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./star.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./star.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./star.vue?vue&type=template&id=4b292aeb&scoped=true&\"\nimport script from \"./star.vue?vue&type=script&lang=js&\"\nexport * from \"./star.vue?vue&type=script&lang=js&\"\nimport style0 from \"./star.vue?vue&type=style&index=0&id=4b292aeb&rel=stylesheet%2Fscss&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4b292aeb\",\n  null\n  \n)\n\nexport default component.exports","<!--对订单进行评论页面-->\n<template>\n  <div id=\"comment\">\n    <v-head title=\"评论\" goBack=\"true\" bgColor=\"#f4f4f4\"></v-head>\n    <div class=\"deliver-comment\">\n      <div class=\"deliver-info\">\n        <div class=\"avatar\">\n          <img src=\"http://5b0988e595225.cdn.sohucs.com/images/20190706/b4b3e0f0244849a59c2ef114308fae2c.jpeg\">\n        </div>\n        <div class=\"info-container\">\n          <span class=\"deliver-type\">美团快送</span>\n          <div class=\"deliver-time\">\n            <span>今天19：10左右送达</span>\n            <span class=\"time-error\">时间不准 <i class=\"iconfont\">&#xe6d7;</i></span>\n          </div>\n        </div>\n      </div>\n      <star @makeScore=\"setDeliveryScore\"></star>\n    </div>\n\n    <div class=\"main-container\">\n      <div class=\"restaurant-info\">\n        <span class=\"avatar\">\n          <img :src=\"restaurant_info.pic_url\">\n        </span>\n        <span class=\"restaurant-name\">{{restaurant_info.name}}</span>\n      </div>\n      <star @makeScore=\"setFoodScore\"></star>\n      <div class=\"food-comment\">\n        <textarea\n          class=\"comment-data\"\n          v-model=\"commentData\"\n          style=\"resize:none\"\n          placeholder=\"亲，菜品口味如何，对包装服务等还满意吗？\"\n          @input=\"input($event);\"></textarea>\n        <span class=\"tip\">至少输入2个字</span>\n      </div>\n\n      <div class=\"upload-picture-container\">\n        <div class=\"uplist-container\" v-for=\"(item,index) in uploadList\" :key=\"index\">\n          <div class=\"pic\">\n            <img :src=\"item\">\n          </div>\n          <div class=\"delete\" @click=\"deletePic(index)\">\n            <i class=\"iconfont icon-delete\">&#xe60d;</i>\n          </div>\n        </div>\n        <label class=\"upload\">\n          <i class=\"iconfont upload-icon\">&#xe782;</i>\n          <input id=\"file\" type=\"file\" ref=\"referenceUpload\" @change=\"fileUpload($event)\" style=\"display: none;\">\n        </label>\n        <div class=\"upload-description\" v-show=\"!uploadList.length\">\n          <h3>上传图片</h3>\n          <p>内容丰富的评论有机会成为优质评价哦</p>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"hidden-name-comment\">\n      <span class=\"selector no-select\" v-if=\"!hiddenName\" @click=\"hiddenName = !hiddenName;\"></span>\n      <span class=\"selector select\" v-else>\n        <i class=\"iconfont\" @click=\"hiddenName = !hiddenName;\">&#xe6da;</i>\n      </span>\n      <h4>匿名评价</h4>\n    </div>\n    <div class=\"submit\" :class=\"{active:satisfySubmit}\" @click=\"submit()\">\n      <span>提交</span>\n    </div>\n    <v-loading v-show=\"loading\"></v-loading>\n    <alert-tip :text=\"alertText\" :showTip.sync=\"showTip\"></alert-tip>\n  </div>\n</template>\n\n<script>\n  import star from './star.vue'\n  import {makeComment, orderInfo} from '@/api/order'\n  import {uploadToken, upload} from '@/api/upload'\n  import config from '@/config'\n\n  export default {\n    data() {\n      return {\n        restaurant_info: {},  //商店信息\n        deliveryScore: 1,   //配送评分\n        foodScore: 1,       //食物评分\n        hiddenName: false,\n        commentValueLength: 0,\n        satisfySubmit: false,\n        commentData: '',\n        uploadList: [],\n        loading: false,\n        alertText: '',      //提示\n        showTip: false\n      }\n    },\n    methods: {\n      setDeliveryScore(score) {\n        this.deliveryScore = score;\n      },\n      setFoodScore(score) {\n        this.foodScore = score;\n      },\n      input($event) {\n        this.commentValueLength = $event.target.value.length;\n        this.satisfySubmit = this.commentValueLength >= 2;\n      },\n      deletePic(index) {\n        this.uploadList.splice(index, 1);\n      },\n      fileUpload(event) {\n        if (this.uploadList.length >= 3) {      //最多上传3张图片\n          this.alertText = '最多上传3张图片'\n          this.showTip = true;\n          return;\n        }\n        this.loading = true;\n        let file = event.target.files[0];\n        uploadToken().then((response) => {   //获取上传凭证\n          if (response.data.status === 200) {\n            let data = {token: response.data.uptoken, file};\n            upload(data).then((upResponse) => {     //上传到七牛云\n              this.uploadList.push(config.domain + upResponse.data.key);\n              this.loading = false;\n            })\n            this.$refs.referenceUpload.value = null;\n          } else {\n            this.alertText = response.data.message;\n            this.showTip = true;\n          }\n        })\n      },\n      submit() {\n        if (!this.satisfySubmit)\n          return;\n        makeComment({\n          hidden_name: this.hiddenName,\n          order_id: this.order_id,\n          comment_data: this.commentData,\n          food_score: this.foodScore,\n          delivery_score: this.deliveryScore,\n          pic_url: this.uploadList\n        }).then((response) => {\n          let res = response.data;\n          let _this = this;\n          _this.alertText = res.message;\n          _this.showTip = true;\n          if (res.status === 200) {\n            setTimeout(() => {\n              _this.$router.push('/index')\n            }, 1000);\n          }\n        })\n      },\n    },\n    created() {\n      let order_id = this.order_id = this.$route.query.order_id;\n      if (!order_id) {\n        this.alertText = '参数有误';\n        this.showTip = true;\n        setTimeout(() => {\n          this.$router.push('/index');\n        }, 1000);\n        return;\n      }\n      orderInfo({order_id}).then((response) => {\n        let res = response.data;\n        if (res.status === 200) {\n          this.restaurant_info = res.data.restaurant;\n        } else {\n          this.alertText = res.message;\n          this.showTip = true;\n          setTimeout(() => {\n            this.$router.go(-1)\n          }, 500)\n        }\n      })\n    },\n    components: {\n      star\n    }\n  }\n</script>\n\n<style rel=\"stylesheet/scss\" lang=\"scss\" scoped>\n  @import \"../../style/mixin.scss\";\n\n  #comment {\n    min-height: 100vh;\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    z-index: 1000;\n    background: #f4f4f4;\n    .avatar {\n      display: inline-block;\n      overflow: hidden;\n      border-radius: 50%;\n      border: 1px solid $mtGrey;\n      @include px2rem(width, 80);\n      @include px2rem(height, 80);\n      margin-right: 0.5rem;\n      img {\n        width: 100%;\n        height: 100%;\n      }\n    }\n\n    .deliver-comment {\n      background: #fff;\n      .deliver-info {\n        display: flex;\n        padding: 0.5rem;\n        .info-container {\n          flex: 1;\n          .deliver-type {\n            font-size: 0.5rem;\n            display: inline-block;\n            margin-bottom: 0.2rem;\n          }\n          .deliver-time {\n            font-size: 0.5rem;\n            .time-error {\n              float: right;\n              font-size: 0.4rem;\n              margin-top: 0.1rem;\n              color: #508aca;\n              .iconfont {\n                border-radius: 50%;\n                border: 1px solid #508aca;\n              }\n            }\n          }\n        }\n      }\n    }\n\n    .main-container {\n      background: #fff;\n      margin-top: 0.5rem;\n      padding: 0.2rem 0.5rem;\n      .restaurant-info {\n        display: flex;\n        align-items: center;\n        margin: 0.2rem 0;\n        .restaurant-name {\n          font-size: 0.5rem;\n        }\n      }\n\n      .food-comment {\n        position: relative;\n        .comment-data {\n          width: 100%;\n          height: 100px;\n          border: 1px solid $mtGrey;\n        }\n        .tip {\n          color: $mtGrey;\n          font-size: 0.4rem;\n          position: absolute;\n          right: 12px;\n          bottom: 12px;\n        }\n      }\n\n      .upload-picture-container {\n        display: flex;\n        margin: 0.3rem 0;\n        align-items: center;\n        .uplist-container {\n          position: relative;\n          margin-right: 0.2rem;\n          border: 1px solid $mtGrey;\n          .pic {\n            @include px2rem(width, 140);\n            @include px2rem(height, 140);\n            img {\n              width: 100%;\n              height: 100%;\n            }\n          }\n          .delete {\n            position: absolute;\n            right: -10px;\n            top: -10px;\n            @include px2rem(width, 45);\n            @include px2rem(height, 45);\n            text-align: center;\n            border-radius: 50%;\n            background: rgb(255, 76, 69);\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            .icon-delete {\n              font-size: 0.35rem;\n              color: #fff;\n            }\n          }\n        }\n\n        .upload {\n          display: inline-block;\n          margin-right: 0.2rem;\n          text-align: center;\n          border: 1px solid $mtGrey;\n          @include px2rem(width, 140);\n          @include px2rem(height, 140);\n          .upload-icon {\n            @include px2rem(line-height, 140);\n            font-size: 1rem;\n          }\n        }\n        .upload-description {\n          font-size: 0.4rem;\n          p {\n            margin-top: 0.2rem;\n            color: $mtGrey;\n          }\n        }\n      }\n    }\n\n    .hidden-name-comment {\n      margin: 0.4rem 0.5rem;\n      .selector {\n        border-radius: 50%;\n        display: inline-block;\n        @include px2rem(width, 35);\n        @include px2rem(height, 35);\n      }\n      .no-select {\n        border: 1px solid $mtGrey;\n      }\n      .select {\n        text-align: center;\n        @include px2rem(line-height, 35);\n        color: #fff;\n        background: $mtYellow;\n        .iconfont {\n          font-size: 0.5rem;\n        }\n      }\n      h4 {\n        display: inline-block;\n        font-size: 0.4rem;\n      }\n    }\n\n    .submit {\n      margin-top: 0.3rem;\n      background: #cbcbcb;\n      @include px2rem(line-height, 95);\n      text-align: center;\n      position: absolute;\n      bottom: 0;\n      left: 0;\n      right: 0;\n      &.active {\n        background: $mtYellow;\n      }\n      span {\n        color: #fff;\n        font-size: 0.5rem;\n      }\n    }\n  }\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./comment.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./comment.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./comment.vue?vue&type=template&id=06d9a368&scoped=true&\"\nimport script from \"./comment.vue?vue&type=script&lang=js&\"\nexport * from \"./comment.vue?vue&type=script&lang=js&\"\nimport style0 from \"./comment.vue?vue&type=style&index=0&id=06d9a368&rel=stylesheet%2Fscss&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"06d9a368\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./star.vue?vue&type=style&index=0&id=4b292aeb&rel=stylesheet%2Fscss&lang=scss&scoped=true&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./comment.vue?vue&type=style&index=0&id=06d9a368&rel=stylesheet%2Fscss&lang=scss&scoped=true&\"","import {_get, _post} from './index'\n\n//提交订单\nexport const submitOrder = (data) => {\n  let req = {\n    data,\n    url: 'v1/order'\n  };\n  return _post(req);\n}\n\n//准备支付\nexport const initPay = (data) => {\n  let req = {\n    data,\n    url: 'v1/pay'\n  }\n  return _post(req);\n}\n\n//获取订单信息\nexport const orderInfo = (data) => {\n  let req = {\n    url: `v1/order/${data.order_id}`\n  }\n  return _get(req);\n}\n\n//获取我的订单\nexport const orders = (data) => {\n  let req = {\n    data,\n    url: 'v1/orders'\n  }\n  return _get(req);\n}\n\n//订单评论\nexport const makeComment = (data) => {\n  let req = {\n    data,\n    url: 'v1/comment'\n  }\n  return _post(req)\n}\n\n\n//请求支付\nexport const requestPay = (data) => {\n  let req = {\n    data,\n    url: '/https://pay.ispay.cn/core/api/request/pay/'\n  }\n  return _post(req)\n}\n\n//监听扫码支付状态\nexport const listenStatus = (data) => {\n  let req = {\n    data,\n    url: 'v1/listen_status'\n  }\n  return _get(req)\n}\n\n"],"sourceRoot":""}