(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0ca87225"],{"91b6":function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"a",(function(){return s}));a("456d"),a("ac6a");var i=a("365c"),n=function(t){var e={data:t,url:"service/uploadtoken"};return Object(i["b"])(e)},s=function(t){var e=new FormData;Object.keys(t).forEach((function(a){e.append(a,t[a])}));var a={data:e,url:"/upload-z2.qiniup.com/"};return Object(i["d"])(a)}},"9b87":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"comment"}},[a("v-head",{attrs:{title:"评论",goBack:"true",bgColor:"#f4f4f4"}}),a("div",{staticClass:"deliver-comment"},[t._m(0),a("star",{on:{makeScore:t.setDeliveryScore}})],1),a("div",{staticClass:"main-container"},[a("div",{staticClass:"restaurant-info"},[a("span",{staticClass:"avatar"},[a("img",{attrs:{src:t.restaurant_info.pic_url}})]),a("span",{staticClass:"restaurant-name"},[t._v(t._s(t.restaurant_info.name))])]),a("star",{on:{makeScore:t.setFoodScore}}),a("div",{staticClass:"food-comment"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.commentData,expression:"commentData"}],staticClass:"comment-data",staticStyle:{resize:"none"},attrs:{placeholder:"亲，菜品口味如何，对包装服务等还满意吗？"},domProps:{value:t.commentData},on:{input:[function(e){e.target.composing||(t.commentData=e.target.value)},function(e){return t.input(e)}]}}),a("span",{staticClass:"tip"},[t._v("至少输入2个字")])]),a("div",{staticClass:"upload-picture-container"},[t._l(t.uploadList,(function(e,i){return a("div",{key:i,staticClass:"uplist-container"},[a("div",{staticClass:"pic"},[a("img",{attrs:{src:e}})]),a("div",{staticClass:"delete",on:{click:function(e){return t.deletePic(i)}}},[a("i",{staticClass:"iconfont icon-delete"},[t._v("")])])])})),a("label",{staticClass:"upload"},[a("i",{staticClass:"iconfont upload-icon"},[t._v("")]),a("input",{ref:"referenceUpload",staticStyle:{display:"none"},attrs:{id:"file",type:"file"},on:{change:function(e){return t.fileUpload(e)}}})]),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.uploadList.length,expression:"!uploadList.length"}],staticClass:"upload-description"},[a("h3",[t._v("上传图片")]),a("p",[t._v("内容丰富的评论有机会成为优质评价哦")])])],2)],1),a("div",{staticClass:"hidden-name-comment"},[t.hiddenName?a("span",{staticClass:"selector select"},[a("i",{staticClass:"iconfont",on:{click:function(e){t.hiddenName=!t.hiddenName}}},[t._v("")])]):a("span",{staticClass:"selector no-select",on:{click:function(e){t.hiddenName=!t.hiddenName}}}),a("h4",[t._v("匿名评价")])]),a("div",{staticClass:"submit",class:{active:t.satisfySubmit},on:{click:function(e){return t.submit()}}},[a("span",[t._v("提交")])]),a("v-loading",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}]}),a("alert-tip",{attrs:{text:t.alertText,showTip:t.showTip},on:{"update:showTip":function(e){t.showTip=e},"update:show-tip":function(e){t.showTip=e}}})],1)},n=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"deliver-info"},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:"http://5b0988e595225.cdn.sohucs.com/images/20190706/b4b3e0f0244849a59c2ef114308fae2c.jpeg"}})]),a("div",{staticClass:"info-container"},[a("span",{staticClass:"deliver-type"},[t._v("美团快送")]),a("div",{staticClass:"deliver-time"},[a("span",[t._v("今天19：10左右送达")]),a("span",{staticClass:"time-error"},[t._v("时间不准 "),a("i",{staticClass:"iconfont"},[t._v("")])])])])])}],s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"star-container"},t._l(t.score,(function(e,i){return a("i",{key:i,class:["iconfont","star",e?"active":"no-active"],on:{click:function(a){return t.makeScore(e,i)}}},[t._v("")])})),0)},r=[],o=(a("ac6a"),{data:function(){return{score:[1,0,0,0,0]}},methods:{makeScore:function(t,e){var a=1==t?0:1;this.score.splice(e,1,a);var i=0;this.score.forEach((function(t){i+=t})),this.$emit("makeScore",i)}}}),c=o,u=(a("b8be"),a("2877")),d=Object(u["a"])(c,s,r,!1,null,"4b292aeb",null),l=d.exports,f=a("f8b7"),v=a("91b6"),m=a("db49"),p={data:function(){return{restaurant_info:{},deliveryScore:1,foodScore:1,hiddenName:!1,commentValueLength:0,satisfySubmit:!1,commentData:"",uploadList:[],loading:!1,alertText:"",showTip:!1}},methods:{setDeliveryScore:function(t){this.deliveryScore=t},setFoodScore:function(t){this.foodScore=t},input:function(t){this.commentValueLength=t.target.value.length,this.satisfySubmit=this.commentValueLength>=2},deletePic:function(t){this.uploadList.splice(t,1)},fileUpload:function(t){var e=this;if(this.uploadList.length>=3)return this.alertText="最多上传3张图片",void(this.showTip=!0);this.loading=!0;var a=t.target.files[0];Object(v["b"])().then((function(t){if(200===t.data.status){var i={token:t.data.uptoken,file:a};Object(v["a"])(i).then((function(t){e.uploadList.push(m["a"].domain+t.data.key),e.loading=!1})),e.$refs.referenceUpload.value=null}else e.alertText=t.data.message,e.showTip=!0}))},submit:function(){var t=this;this.satisfySubmit&&Object(f["c"])({hidden_name:this.hiddenName,order_id:this.order_id,comment_data:this.commentData,food_score:this.foodScore,delivery_score:this.deliveryScore,pic_url:this.uploadList}).then((function(e){var a=e.data,i=t;i.alertText=a.message,i.showTip=!0,200===a.status&&setTimeout((function(){i.$router.push("/index")}),1e3)}))}},created:function(){var t=this,e=this.order_id=this.$route.query.order_id;if(!e)return this.alertText="参数有误",this.showTip=!0,void setTimeout((function(){t.$router.push("/index")}),1e3);Object(f["d"])({order_id:e}).then((function(e){var a=e.data;200===a.status?t.restaurant_info=a.data.restaurant:(t.alertText=a.message,t.showTip=!0,setTimeout((function(){t.$router.go(-1)}),500))}))},components:{star:l}},h=p,b=(a("d83c"),Object(u["a"])(h,i,n,!1,null,"06d9a368",null));e["default"]=b.exports},ab77:function(t,e,a){},b8be:function(t,e,a){"use strict";a("ec8b")},d83c:function(t,e,a){"use strict";a("ab77")},ec8b:function(t,e,a){},f8b7:function(t,e,a){"use strict";a.d(e,"f",(function(){return n})),a.d(e,"a",(function(){return s})),a.d(e,"d",(function(){return r})),a.d(e,"e",(function(){return o})),a.d(e,"c",(function(){return c})),a.d(e,"b",(function(){return u}));var i=a("365c"),n=function(t){var e={data:t,url:"v1/order"};return Object(i["c"])(e)},s=function(t){var e={data:t,url:"v1/pay"};return Object(i["c"])(e)},r=function(t){var e={url:"v1/order/".concat(t.order_id)};return Object(i["b"])(e)},o=function(t){var e={data:t,url:"v1/orders"};return Object(i["b"])(e)},c=function(t){var e={data:t,url:"v1/comment"};return Object(i["c"])(e)},u=function(t){var e={data:t,url:"v1/listen_status"};return Object(i["b"])(e)}}}]);
//# sourceMappingURL=chunk-0ca87225.d1075b0a.js.map