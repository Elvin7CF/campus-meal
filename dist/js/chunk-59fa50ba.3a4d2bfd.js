(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-59fa50ba"],{"0df5":function(t,e,s){"use strict";s("4e64")},"2c66":function(t,e,s){"use strict";s("7c0e")},"4e64":function(t,e,s){},"7c0e":function(t,e,s){},de1c:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"nearby-shops"},[s("nav",{ref:"nav"},[t._m(0)]),s("article",t._l(t.shopLists,(function(e){return s("router-link",{key:e.id,attrs:{to:{path:"store",query:{id:e.id}},tag:"section"}},[s("div",{staticClass:"img-show"},[s("img",{attrs:{src:e.pic_url}})]),s("div",{staticClass:"detail"},[s("h4",[t._v(t._s(e.name))]),s("div",{staticClass:"shops-message"},[s("v-star",{attrs:{score:e.wm_poi_score}}),s("span",{staticClass:"sell-num"},[t._v(t._s(e.month_sales_tip))]),s("div",{staticClass:"delivery-info"},[s("span",{staticClass:"deliver-time"},[t._v(t._s(e.delivery_time_tip)+"/")]),s("span",{staticClass:"distance"},[t._v(t._s(e.distance))])])],1),s("div",{staticClass:"price-message"},[s("span",[t._v(t._s(e.min_price_tip)+" | ")]),s("span",[t._v(t._s(e.shipping_fee_tip)+" | ")]),s("span",[t._v(t._s(e.average_price_tip))])]),s("div",{staticClass:"active-message"},[s("ul",t._l(e.discounts2.slice(0,1),(function(e,i){return s("li",{key:i},[s("div",{staticClass:"discount-left"},[s("img",{staticClass:"icon",attrs:{src:e.icon_url}}),s("span",{staticClass:"info"},[t._v(t._s(e.info))])]),0===i?s("router-link",{attrs:{to:"/shops"}},[s("i",{staticClass:"iconfont icon-entry"},[t._v("")])]):t._e()],1)})),0)])])])})),1),s("div",{ref:"loading",staticClass:"loading-wrap"},[s("span",{directives:[{name:"show",rawName:"v-show",value:t.loading&&!t.noMore,expression:"loading && !noMore"}],staticClass:"loading"},[t._v("正在努力加载中…")]),s("span",{directives:[{name:"show",rawName:"v-show",value:t.noMore,expression:"noMore"}],staticClass:"no-more"},[t._v("已经到底了")])])])},r=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",[s("li",[t._v("综合排序 "),s("i",{staticClass:"iconfont icon-sort"},[t._v("")])]),s("li",[t._v("销量最高")]),s("li",[t._v("距离最近")]),s("li",[t._v("筛选")])])}],a=(s("8e6e"),s("456d"),s("ac6a"),s("bd86")),n=s("1fba"),o=s("00dc"),c=s("2f62");function l(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function p(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?l(Object(s),!0).forEach((function(e){Object(a["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var u={data:function(){return{shopLists:[],showSort:!1,BScrollEvent:null,loading:!1,page:1,limit:4,noMore:!1,preventRepeat:!1}},computed:p({},Object(c["b"])(["address"])),props:["scrollWrapper"],methods:{listenScroll:function(){var t=this;t.BScrollEvent.on("scroll",(function(e){Math.abs(e.y)+t.scrollWrapper.clientHeight>=t.scrollWrapper.childNodes[0].clientHeight-30&&(t.loading||(t.loading=!0,t.getRestaurants(t.page,t.limit,(function(e){t.page++,e.forEach((function(e){t.shopLists.push(e)})),t.$nextTick((function(){t.loading=!1,t.BScrollEvent.refresh()}))}))))}))},getRestaurants:function(t,e,s){var i=this;if(!this.noMore&&!this.preventRepeat){this.preventRepeat=!0;var r=(t-1)*e,a=this.address,n=a.lat,c=a.lng;Object(o["c"])({offset:r,limit:e,lng:c,lat:n}).then((function(t){var e=t.data.data;i.preventRepeat=!1,i.noMore=e.length<i.limit,s(e)}))}},firstFetch:function(){var t=this;this.page=1,this.getRestaurants(this.page,this.limit,(function(e){t.page++,t.shopLists=e,t.$nextTick((function(){t.BScrollEvent=new n["a"](t.scrollWrapper,{click:!0,probeType:2}),t.listenScroll()}))}))}},created:function(){var t=this.address,e=t.lat,s=t.lng;e&&s?(this.shopLists=[],this.firstFetch()):this.$store.dispatch("location")},watch:{address:function(t){this.noMore=!1,this.preventRepeat=!1;var e=t.lat,s=t.lng;e&&s&&(this.shopLists=[],this.firstFetch())}}},f=u,d=(s("0df5"),s("2877")),h=Object(d["a"])(f,i,r,!1,null,"7f01df9b",null);e["a"]=h.exports},f4ba:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"scrollWrapper",staticClass:"wrapper"},[s("div",{attrs:{id:"food-type"}},[s("v-head",{attrs:{title:t.type,goBack:"true",bgColor:"#f4f4f4"}}),s("nearby-shops",{attrs:{ready:!0,scrollWrapper:t.scrollWrapper}})],1)])},r=[],a=s("de1c"),n={data:function(){return{scrollWrapper:null,type:""}},mounted:function(){this.type=this.$route.query.type||"美食",this.scrollWrapper=this.$refs.scrollWrapper,this.$store.dispatch("locationReady",!0)},components:{"nearby-shops":a["a"]}},o=n,c=(s("2c66"),s("2877")),l=Object(c["a"])(o,i,r,!1,null,"e1870e5e",null);e["default"]=l.exports}}]);
//# sourceMappingURL=chunk-59fa50ba.3a4d2bfd.js.map